# IT5 Dantean Style Transfer

Materials for the final project of the "Human Language Technologies" course (M.Sc. Cognitive Science, UniTn/CIMeC).

The project is to perform Text Style Transfer from standard italian to Dantean italian (medieval italian). Text Style Transfer is a task in which the *source style* (italian) of a text is changed to a chosen *target style* (Dantean). The task aims to change the style of a given sentence while preserving its semantics.

## Dataset

The dataset used for this project is called ita2dante dataset. It contains all the sentences from Dante's "Divine Comedy" along with paraphrases in contemporary italian (approximately 6k pairs in total). The data is scraped from [divinacommedia.weebly.com](https://divinacommedia.weebly.com/). The dataset can be found in the folder `dataset`. The folder `dataset` also contains three other files: [scraper.py](dataset/scraper.py), [create_dataset.py](dataset/create_dataset.py), [ita2dante_analysis.ipynb](dataset/ita2dante_analysis.ipynb). [scraper.py](dataset/scraper.py) is the python script used to scrape sentences from Dante and paraphrases. The scraped text is not perfectly aligned, and for this reason part of the alignment was done manually. [create_dataset.py](dataset/create_dataset.py) is the script used to create the dataset with aligned scraped text (n.b. it yelds the correct result only with aligned text). [analysis.ipynb](dataset/analysis.ipynb) contains an analysis of some linguistic features of the dataset.



Here are the first three rows of the ita2dante dataset:

italian | dante
------------- | -------------
A metà del percorso della vita umana, mi ritrovai per una oscura foresta, poiché avevo smarrito la giusta strada  | Nel mezzo del cammin di nostra vita mi ritrovai per una selva oscura, ché la diritta via era smarrita
Ahimè, è difficile descrivere com'era quella foresta, selvaggia, inestricabile e tremenda, tale che al solo pensiero fa tornare la paura | Ahi quanto a dir qual era è cosa dura esta selva selvaggia e aspra e forte che nel pensier rinova la paura
È così spaventosa che la morte lo è poco di più | Tant’è amara che poco è più morte

## Approach

Text Style Transfer is performed here using a supervised approach. Supervised methods adopt the standard neural sequence-to-sequence (seq2seq) model with the encoder-decoder architecture. More precisely, I fine-tuned a T5 Transformer model having sentences in italian as input and original sentences from Dante as output. 

The model used for the fine-tuning is [gsarti/it5-small](https://huggingface.co/gsarti/it5-small) from Giovanni Sarti and Malvina Nissim, released as part of the project ["IT5: Large-Scale Text-to-Text Pretraining for Italian Language Understanding and Generation"](https://arxiv.org/abs/2203.03759).

The notebook used for the fine-tuning is [it5_fine-tuning.ipynb](it5_fine-tuning.ipynb), the folder `example_results` contain text generated by a model fine-tuned for 8 epochs using [AdamW](https://pytorch.org/docs/stable/generated/torch.optim.AdamW.html) optimizer and a learning rate of 5e-4. [output_dante.csv](example_results/output_dante.csv) contains outputs from italian paraphrases of the "Divine Comedy" compared with original sentences from Dante, whereas [output_rwd.csv](example_results/output_rwd.csv) contains outputs from random sentences in italian.

Here are three example rows from [output_rwd.csv](example_results/output_rwd.csv):

input | output
------------- | -------------
Credo che ora sia indubbiamente più difficile, ma non è impossibile. | Ond’io credo che ora sia più difficile, ma non è arduo.
Gli abitanti del paesino erano molto legati alle loro tradizioni, proprio perché non avevano contatti con persone di altri posti. | Li abitanti del paesino eran molto legati a loro usanze, sì che non avean contatti con altri posti.
È un po’ come un uccello che riesce ad entrare in una finestra secondi prima che questa si chiuda, scoprendo che qualche penna della coda è rimasta incastrata. | È un po’ come uccel che s’incroci ad entrar in una finestra ond’e’ si chiuda, scoprendo che qualche penna c’è rimasta.

## Limitations

The biggest limitation for this project is the size of the ita2dante dataset. In fact, it consists only of 6K sentences whereas [gsarti/it5-small](https://huggingface.co/gsarti/it5-small) has more than 70M parameters.

